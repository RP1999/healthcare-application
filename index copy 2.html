<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MediLink Dashboard — Healthcare Application</title>

  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800;900&display=swap" rel="stylesheet">

  <style>
    :root{
  --bg:#070a1d;
  --bg-light:#161b33;
  --card:#ffffff;
      --muted:#98a8bf;
      --accent:#2b8cff;
      --accent-2:#00c48c;
      --purple:#7b61ff;
      --danger:#ff7a45;
      --glass: rgba(255,255,255,0.08);
      --shadow: 0 8px 28px rgba(16,32,58,0.06);
      --radius:16px;
      --page-pad:28px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;padding:0}
    body{
      margin:0;
      font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  background: var(--bg);
      color: #10203a;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.5;
      padding: var(--page-pad);
      position:relative;
      overflow-x:hidden;
    }

    /* Animated Background */
    .bg-animation{
      position:fixed;
      top:0;left:0;right:0;bottom:0;
      z-index:0;
      overflow:hidden;
    }
    .bg-animation::before{
      content:'';
      position:absolute;
      top:0;left:0;right:0;bottom:0;
      /* Beautiful medical/hospital background from Unsplash 
         Alternative images you can try:
         - https://images.unsplash.com/photo-1519494026892-80bbd2d6fd0d (Medical tech)
         - https://images.unsplash.com/photo-1581594693702-fbdc51b2763b (Modern hospital)
         - https://images.unsplash.com/photo-1584982751601-97dcc096659c (Medical equipment)
         - https://images.unsplash.com/photo-1538108149393-fbbd81895907 (Healthcare professional)
      */
      background-image: url('https://images.unsplash.com/photo-1576091160399-112ba8d25d1d?auto=format&fit=crop&w=2000&q=80');
      background-size:cover;
      background-position:center;
      background-attachment:fixed;
      filter:blur(0px) brightness(0.75) contrast(1.05);
      transform:scale(1.1);
    }
    .bg-animation::after{
      content:'';
      position:absolute;
      top:0;left:0;right:0;bottom:0;
      background: 
        linear-gradient(135deg, rgba(10,14,39,0.65) 0%, rgba(26,31,58,0.54) 50%, rgba(15,20,40,0.62) 100%),
        radial-gradient(circle at 20% 50%, rgba(43,140,255,0.18) 0%, transparent 55%),
        radial-gradient(circle at 80% 80%, rgba(123,97,255,0.16) 0%, transparent 55%),
        radial-gradient(circle at 40% 20%, rgba(0,196,140,0.14) 0%, transparent 55%);
      animation: bgFloat 20s ease-in-out infinite;
    }

    @keyframes bgFloat{
      0%, 100%{ transform: translate(0, 0) rotate(0deg); }
      33%{ transform: translate(-5%, 5%) rotate(2deg); }
      66%{ transform: translate(5%, -5%) rotate(-2deg); }
    }

    /* Floating particles */
    .particles{
      position:fixed;
      top:0;left:0;right:0;bottom:0;
      z-index:1;
      pointer-events:none;
      background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 0L30 60M0 30L60 30' stroke='rgba(255,255,255,0.015)' stroke-width='1'/%3E%3C/svg%3E");
      background-size:60px 60px;
    }
    .particle{
      position:absolute;
      width:4px;height:4px;
      background:rgba(43,140,255,0.5);
      border-radius:50%;
      box-shadow:0 0 10px rgba(43,140,255,0.4);
      animation: particleFloat 15s linear infinite;
    }
    @keyframes particleFloat{
      0%{ transform: translateY(100vh) translateX(0) scale(0); opacity:0; }
      10%{ opacity:0.6; }
      90%{ opacity:0.6; }
      100%{ transform: translateY(-100px) translateX(100px) scale(1); opacity:0; }
    }

    /* Content wrapper */
    .content-wrapper{
      position:relative;
      z-index:2;
    }

    /* Header / Topbar */
    .topbar{
      display:flex;
      align-items:center;
      gap:20px;
      margin-bottom:24px;
      padding:16px 24px;
  background:rgba(17,23,46,0.35);
  backdrop-filter:blur(22px) saturate(160%);
  border-radius:var(--radius);
  border:1px solid rgba(255,255,255,0.18);
  box-shadow: 0 12px 36px rgba(8,14,38,0.45);
      animation: slideDown 0.6s ease;
    }
    @keyframes slideDown{
      from{ opacity:0; transform:translateY(-30px); }
      to{ opacity:1; transform:translateY(0); }
    }
    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      text-decoration:none;
      color:#fff;
    }
    .logo {
      width:48px;height:48px;border-radius:12px;
      display:inline-grid;place-items:center;
      background:linear-gradient(135deg,var(--accent),var(--purple));
      color:white;font-weight:800;font-size:20px;
      box-shadow: 0 8px 24px rgba(43,140,255,0.4);
      animation: pulse 2s ease-in-out infinite;
    }
    @keyframes pulse{
      0%, 100%{ transform:scale(1); }
      50%{ transform:scale(1.05); }
    }
    nav.topnav{
      display:flex;
      gap:8px;
      margin-left:28px;
      align-items:center;
      flex:1;
    }
    nav.topnav a{
      color:rgba(255,255,255,0.7);
      text-decoration:none;
      font-weight:600;
      padding:10px 18px;
      border-radius:10px;
      cursor: pointer;
      transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position:relative;
      overflow:hidden;
    }
    nav.topnav a::before{
      content:'';
      position:absolute;
      top:0;left:0;right:0;bottom:0;
      background:linear-gradient(135deg, var(--accent), var(--purple));
      opacity:0;
      transition:opacity 0.3s ease;
      z-index:-1;
    }
    nav.topnav a:hover{
      color:white;
      transform:translateY(-2px);
    }
    nav.topnav a.active{
      color:white;
      background:rgba(43,140,255,0.2);
      box-shadow: 0 4px 20px rgba(43,140,255,0.3);
    }
    nav.topnav a.active::before{
      opacity:0.3;
    }
    .user-area{
      display:flex;
      align-items:center;
      gap:12px;
    }
    .user-area .avatar{
      width:40px;height:40px;border-radius:10px;
      background:linear-gradient(135deg,var(--accent),var(--purple));
      color:white;
      display:inline-grid;place-items:center;font-weight:700;
      box-shadow:0 4px 16px rgba(43,140,255,0.3);
      animation: avatarGlow 3s ease-in-out infinite;
    }
    @keyframes avatarGlow{
      0%, 100%{ box-shadow:0 4px 16px rgba(43,140,255,0.3); }
      50%{ box-shadow:0 4px 24px rgba(43,140,255,0.5); }
    }
    .btn-outline{
      padding:10px 16px;border-radius:10px;
      border:1px solid rgba(255,255,255,0.25);
      background:rgba(255,255,255,0.06);
      backdrop-filter:blur(20px);
      color:white;font-weight:600;cursor:pointer;
      transition:all 0.3s ease;
    }
    .btn-outline:hover{
      background:rgba(255,255,255,0.12);
      border-color:rgba(255,255,255,0.4);
      transform:translateY(-2px);
      box-shadow:0 8px 24px rgba(0,0,0,0.3);
    }

    /* Main layout */
    .container{
      max-width:1200px;
      margin: 16px auto 60px;
      animation: fadeInUp 0.8s ease 0.2s both;
    }
    @keyframes fadeInUp{
      from{ opacity:0; transform:translateY(30px); }
      to{ opacity:1; transform:translateY(0); }
    }
    .dashboard-header{
      display:flex;
      align-items:flex-start;
      gap:20px;
      justify-content:space-between;
      margin-bottom:24px;
    }
    .title-block h1{
      margin:0;font-size:32px;color:white;font-weight:800;
      text-shadow:0 2px 20px rgba(43,140,255,0.3);
    }
    .title-block p{margin:8px 0 0;color:rgba(255,255,255,0.6);font-size:14px}

    /* Stats row */
    .stats-row{
      display:grid;
      grid-template-columns:repeat(4,1fr);
      gap:20px;
      margin-top:24px;
    }
    .stat{
  background:rgba(18,24,48,0.42);
  backdrop-filter:blur(22px) saturate(160%);
      border-radius:16px;
      padding:24px;
      border:1px solid rgba(255,255,255,0.15);
      box-shadow:0 8px 32px rgba(0,0,0,0.3);
      display:flex;
      flex-direction:column;
      gap:12px;
      cursor:pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position:relative;
      overflow:hidden;
      animation: scaleIn 0.6s ease both;
    }
    .stat:nth-child(1){ animation-delay:0.1s; }
    .stat:nth-child(2){ animation-delay:0.2s; }
    .stat:nth-child(3){ animation-delay:0.3s; }
    .stat:nth-child(4){ animation-delay:0.4s; }
    @keyframes scaleIn{
      from{ opacity:0; transform:scale(0.8); }
      to{ opacity:1; transform:scale(1); }
    }
    .stat::before{
      content:'';
      position:absolute;
      top:-50%;left:-50%;
      width:200%;height:200%;
      background:linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
      transition:all 0.6s ease;
      transform:rotate(45deg);
    }
    .stat:hover::before{
      left:100%;
    }
    .stat:hover{ 
      transform: translateY(-8px) scale(1.02); 
      box-shadow: 0 20px 60px rgba(43,140,255,0.4);
      border-color:rgba(43,140,255,0.5);
      background:rgba(255,255,255,0.1);
    }
    .stat .meta{display:flex;gap:14px;align-items:center}
    .stat .meta .icon{
      width:56px;height:56px;border-radius:14px;display:grid;place-items:center;color:white;
      background:linear-gradient(135deg,var(--accent),#4ab3ff);
      flex:0 0 56px;
      box-shadow:0 8px 24px rgba(43,140,255,0.4);
      transition:all 0.3s ease;
    }
    .stat:hover .meta .icon{
      transform:rotate(360deg) scale(1.1);
    }
    .stat .value{font-size:28px;font-weight:900;color:white;text-shadow:0 2px 10px rgba(255,255,255,0.2)}
    .stat .label{color:rgba(255,255,255,0.6);font-size:13px;font-weight:600}
    .stat .delta{font-size:13px;color:var(--accent-2);font-weight:700;display:flex;align-items:center;gap:4px}

    /* Grid: main + sidebar */
    .layout{
      display:grid;
      grid-template-columns: 1fr 340px;
      gap:24px;
      margin-top:28px;
      align-items:start;
    }

    /* Card styling */
    .card{
  background:rgba(18,24,48,0.4);
  backdrop-filter:blur(22px) saturate(160%);
      border-radius:var(--radius);
      padding:24px;
      border:1px solid rgba(255,255,255,0.15);
      box-shadow:0 8px 32px rgba(0,0,0,0.4);
      animation: fadeInUp 0.6s ease both;
      transition:all 0.3s ease;
      position:relative;
      overflow:hidden;
    }
    .card::after{
      content:'';
      position:absolute;
      top:0;left:0;right:0;
      height:2px;
      background:linear-gradient(90deg, var(--accent), var(--purple), var(--accent-2));
      opacity:0.7;
    }
    .card:hover{
      border-color:rgba(255,255,255,0.25);
      box-shadow:0 16px 48px rgba(0,0,0,0.5);
      background:rgba(255,255,255,0.08);
    }
    .card h3{
      color:white;
      margin:0 0 8px;
      font-weight:800;
      font-size:20px;
    }

    /* Modules grid */
    .modules-grid{
      display:grid;
      grid-template-columns:repeat(2,1fr);
      gap:16px;
    }
    .module{
      border-radius:14px;
      padding:20px;
      display:flex;
      gap:16px;
      align-items:flex-start;
  background:rgba(15,21,42,0.5);
  backdrop-filter:blur(18px);
  border:1px solid rgba(255,255,255,0.18);
      cursor:pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position:relative;
      overflow:hidden;
    }
    .module::before{
      content:'';
      position:absolute;
      top:0;left:0;right:0;bottom:0;
      background:linear-gradient(135deg, rgba(43,140,255,0.15), rgba(123,97,255,0.15));
      opacity:0;
      transition:opacity 0.3s ease;
    }
    .module:hover::before{
      opacity:1;
    }
    .module:hover{ 
      transform: translateY(-6px) scale(1.02); 
      box-shadow: 0 16px 48px rgba(43,140,255,0.3);
      border-color:rgba(43,140,255,0.5);
  background:rgba(15,21,42,0.48);
  backdrop-filter:blur(18px);
  border:1px solid rgba(255,255,255,0.18);
      width:56px;height:56px;border-radius:12px;display:grid;place-items:center;
      background:linear-gradient(135deg,#4ab3ff,#2b8cff);
      flex:0 0 56px;
      box-shadow: 0 8px 24px rgba(75,162,255,0.3);
      font-size:24px;
      transition:all 0.3s ease;
    }
    .module:hover .m-icon{
      transform:scale(1.1) rotate(5deg);
    }
    .module h4{margin:0;font-size:16px;color:white;font-weight:700}
    .module p{margin:6px 0 0;color:rgba(255,255,255,0.6);font-size:13px}
    .module .badge{
      margin-top:12px;display:inline-block;padding:6px 10px;border-radius:8px;
      background:rgba(43,140,255,0.2);color:var(--accent);font-weight:700;font-size:11px;
      border:1px solid rgba(43,140,255,0.3);
    }

    /* Sidebar quick actions */
    .quick-actions{display:flex;flex-direction:column;gap:12px}
    .action-btn{
      display:flex;align-items:center;gap:12px;padding:14px 16px;border-radius:12px;
      border:1px solid rgba(255,255,255,0.12);
      text-decoration:none;
      background:rgba(255,255,255,0.04);
      backdrop-filter:blur(20px);
      font-weight:700;color:white;cursor:pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position:relative;
      overflow:hidden;
    }
    .action-btn::before{
      content:'';
      position:absolute;
      top:50%;left:50%;
      width:0;height:0;
      border-radius:50%;
      background:rgba(255,255,255,0.15);
      transition:all 0.5s ease;
      transform:translate(-50%, -50%);
    }
    .action-btn:hover::before{
      width:300px;height:300px;
    }
    .action-btn:hover{ 
      transform: translateX(4px);
      box-shadow: 0 8px 24px rgba(43,140,255,0.4);
      border-color:rgba(255,255,255,0.25);
      background:rgba(255,255,255,0.08);
    }
    .action-btn svg{width:20px;height:20px;flex:0 0 20px;position:relative;z-index:1}
    .action-btn span{position:relative;z-index:1}
    .action-btn.green{border-color:rgba(0,196,140,0.3);background:rgba(0,196,140,0.1)}
    .action-btn.green:hover{box-shadow:0 8px 24px rgba(0,196,140,0.3)}
    .action-btn.purple{border-color:rgba(123,97,255,0.3);background:rgba(123,97,255,0.1)}
    .action-btn.purple:hover{box-shadow:0 8px 24px rgba(123,97,255,0.3)}

    .status-list{display:flex;flex-direction:column;gap:12px;margin-top:12px}
    .status-item{
      display:flex;justify-content:space-between;align-items:center;padding:14px;
      border-radius:12px;background:rgba(255,255,255,0.04);
      backdrop-filter:blur(20px);
      border:1px solid rgba(255,255,255,0.12);
      transition:all 0.3s ease;
    }
    .status-item:hover{
      background:rgba(255,255,255,0.08);
      transform:translateX(4px);
      border-color:rgba(255,255,255,0.2);
    }
    .pill{
      padding:6px 12px;border-radius:999px;font-weight:700;font-size:11px;
      border:1px solid;
    }
    .pill.green{background:rgba(0,196,140,0.2);color:#00c48c;border-color:rgba(0,196,140,0.3)}
    .pill.yellow{background:rgba(255,184,107,0.2);color:#ffb86b;border-color:rgba(255,184,107,0.3)}
    .pill.purple{background:rgba(123,97,255,0.2);color:#7b61ff;border-color:rgba(123,97,255,0.3)}

    /* Recent Activity */
    .recent-list{display:flex;flex-direction:column;gap:12px}
    .activity{
      display:flex;justify-content:space-between;gap:12px;padding:16px;
      border-radius:12px;border:1px solid rgba(255,255,255,0.12);
      background:rgba(255,255,255,0.04);
      backdrop-filter:blur(20px);
      cursor:default;
      transition:all 0.3s ease;
    }
    .activity:hover{
      background:rgba(255,255,255,0.08);
      transform:translateX(4px);
      border-color:rgba(255,255,255,0.2);
      box-shadow:0 4px 20px rgba(0,0,0,0.2);
    }
    .activity .left{display:flex;gap:14px;align-items:center}
    .activity .avatar-sm{
      width:48px;height:48px;border-radius:10px;
      background:linear-gradient(135deg,var(--accent),var(--purple));
      display:grid;place-items:center;color:white;font-weight:800;
      box-shadow:0 4px 16px rgba(43,140,255,0.3);
    }
    .activity .meta strong{display:block;color:white;font-weight:700}
    .muted{color:rgba(255,255,255,0.5);font-size:13px}
    .muted-2{color:rgba(255,255,255,0.7);font-size:13px}

    /* Live badge */
    .live-badge{
      background:rgba(0,196,140,0.2);
      padding:10px 16px;
      border-radius:999px;
      color:#00c48c;
      font-weight:800;
      font-size:11px;
      border:1px solid rgba(0,196,140,0.3);
      animation: livePulse 2s ease-in-out infinite;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .live-badge::before{
      content:'';
      width:8px;height:8px;
      background:#00c48c;
      border-radius:50%;
      animation: dotPulse 1.5s ease-in-out infinite;
      box-shadow:0 0 12px rgba(0,196,140,0.6);
    }
    @keyframes livePulse{
      0%, 100%{ box-shadow:0 0 0 rgba(0,196,140,0.4); }
      50%{ box-shadow:0 0 20px rgba(0,196,140,0.6); }
    }
    @keyframes dotPulse{
      0%, 100%{ transform:scale(1); }
      50%{ transform:scale(1.3); }
    }

    /* Forms */
    input, select, textarea{
      padding:12px 16px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.2);
      background:rgba(255,255,255,0.04);
      backdrop-filter:blur(20px);
      color:white;
      font-family:inherit;
      font-size:14px;
      transition:all 0.3s ease;
    }
    input:focus, select:focus, textarea:focus{
      outline:none;
      border-color:var(--accent);
      background:rgba(255,255,255,0.08);
      box-shadow:0 0 0 4px rgba(43,140,255,0.15);
    }
    input::placeholder, textarea::placeholder{
      color:rgba(255,255,255,0.4);
    }

    /* Tables */
    table{
      width:100%;
      border-collapse:collapse;
      margin-top:12px;
    }
    thead tr{
      color:rgba(255,255,255,0.6);
      font-weight:700;
      font-size:12px;
      text-transform:uppercase;
      letter-spacing:0.5px;
    }
    thead th{
      padding:12px 8px;
      text-align:left;
      border-bottom:2px solid rgba(255,255,255,0.1);
    }
    tbody tr{
      border-bottom:1px solid rgba(255,255,255,0.08);
      transition:all 0.3s ease;
    }
    tbody tr:hover{
      background:rgba(255,255,255,0.06);
      backdrop-filter:blur(10px);
    }
    tbody td{
      padding:16px 8px;
      color:white;
    }
    .patient-row{
      cursor:pointer;
    }

    /* Footer */
    footer.small{
      margin-top:40px;
      text-align:center;
      color:rgba(255,255,255,0.4);
      font-size:13px;
    }

    /* Page transitions */
    .page-enter{
      animation: pageEnter 0.5s ease;
    }
    @keyframes pageEnter{
      from{ opacity:0; transform:translateY(20px); }
      to{ opacity:1; transform:translateY(0); }
    }

    /* Loading spinner */
    .loading{
      display:inline-block;
      width:20px;height:20px;
      border:3px solid rgba(255,255,255,0.2);
      border-top-color:var(--accent);
      border-radius:50%;
      animation:spin 0.8s linear infinite;
    }
    @keyframes spin{
      to{ transform:rotate(360deg); }
    }

    /* Responsive */
    @media (max-width: 1000px){
      .stats-row{grid-template-columns:repeat(2,1fr)}
      .layout{grid-template-columns:1fr}
    }
    @media (max-width:600px){
      body{padding:14px}
      nav.topnav{display:none}
      .brand{gap:8px}
      .stat .value{font-size:24px}
      .modules-grid{grid-template-columns:1fr}
      .stats-row{grid-template-columns:1fr}
      .title-block h1{font-size:24px}
    }

    /* Focus styles */
    .action-btn:focus, .btn-outline:focus, nav.topnav a:focus, .module:focus, .stat:focus {
      outline: 3px solid rgba(43,140,255,0.3);
      outline-offset: 3px;
    }
  </style>
</head>
<body>
  <!-- Animated Background -->
  <div class="bg-animation"></div>
  <div class="particles" id="particles"></div>

  <div class="content-wrapper">
    <header class="topbar" role="banner">
      <a class="brand" href="#" data-action="#home">
        <div class="logo">ML</div>
        <div>
          <div style="font-weight:800;color:white">MediLink</div>
          <div style="font-size:11px;color:rgba(255,255,255,0.6)">Health Diagnostics</div>
        </div>
      </a>

      <nav class="topnav" role="navigation" aria-label="main">
        <a class="active" href="#home" data-action="#home">Home</a>
        <a href="#patients" data-action="#patients">Patients</a>
        <a href="#doctors" data-action="#doctors">Doctors</a>
        <a href="#appointments" data-action="#appointments">Appointments</a>
        <a href="#billing" data-action="#billing">Billing</a>
      </nav>

      <div class="user-area" aria-hidden="false">
        <div class="muted-2">Hi, <strong style="color:white">Dr. Smith</strong></div>
        <div class="avatar">DS</div>
        <button class="btn-outline" data-action="logout" title="Logout">Logout</button>
      </div>
    </header>

    <main class="container">
      <section class="dashboard-header" id="home">
        <div class="title-block">
          <h1>MediLink Dashboard</h1>
          <p>Welcome back, Dr. Smith. Here's your overview for today.</p>
        </div>

        <div class="live-badge">
          LIVE · ALL SYSTEMS OPERATIONAL
        </div>
      </section>

      <section class="stats-row" aria-label="Key metrics">
        <div class="stat" role="button" tabindex="0" data-action="patients-list">
          <div class="meta">
            <div class="icon" aria-hidden="true">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16 11c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM6 11c1.657 0 3-1.343 3-3S7.657 5 6 5 3 6.343 3 8s1.343 3 3 3zM6 13c-2.673 0-8 1.343-8 4v2h18v-2c0-2.657-5.327-4-8-4zm10 0c-.29 0-.571.013-.852.036C15.894 13.25 17 14.02 17 15v2h5v-2c0-2.657-5.327-4-8-4z" fill="currentColor"/></svg>
            </div>
          </div>
          <div>
            <div class="label">Active Patients</div>
            <div class="value">2,847</div>
            <div class="delta">↑ +12% <span class="muted">vs last month</span></div>
          </div>
        </div>

        <div class="stat" role="button" tabindex="0" data-action="appointments">
          <div class="meta">
            <div class="icon" style="background:linear-gradient(135deg,#60d394,#00c48c)">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M7 10h5v5H7z" fill="currentColor"/><path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM5 20V9h14v11H5z" fill="currentColor"/></svg>
            </div>
          </div>
          <div>
            <div class="label">Today's Appointments</div>
            <div class="value">156</div>
            <div class="delta" style="color:#00c48c">↑ +8%</div>
          </div>
        </div>

        <div class="stat" role="button" tabindex="0" data-action="staff">
          <div class="meta">
            <div class="icon" style="background:linear-gradient(135deg,#9d8bff,#7b61ff)">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M12 12c2.206 0 4-1.794 4-4s-1.794-4-4-4-4 1.794-4 4 1.794 4 4 4zM6 18c0-2.21 3.582-4 6-4s6 1.79 6 4v1H6v-1z" fill="currentColor"/></svg>
            </div>
          </div>
          <div>
            <div class="label">Medical Staff</div>
            <div class="value">89</div>
            <div class="delta" style="color:#7b61ff">↑ +5%</div>
          </div>
        </div>

        <div class="stat" role="button" tabindex="0" data-action="billing">
          <div class="meta">
            <div class="icon" style="background:linear-gradient(135deg,#ffb36b,#ff7a45)">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M12 2v4M8 6h8M7 10h10M12 22v-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </div>
          </div>
          <div>
            <div class="label">Monthly Revenue</div>
            <div class="value">$284K</div>
            <div class="delta" style="color:#ff7a45">↑ +15%</div>
          </div>
        </div>
      </section>

      <section class="layout">
        <div>
          <div class="card">
            <h3>System Modules</h3>
            <div class="muted" style="margin-bottom:16px">Access all healthcare management features</div>

            <div class="modules-grid">
              <div class="module" role="button" tabindex="0" data-action="patients-list">
                <div class="m-icon" style="background:linear-gradient(135deg,#4ab3ff,#2b8cff)">🧾</div>
                <div>
                  <h4>Patient Management</h4>
                  <p>Manage patient records, medical history, and treatment plans.</p>
                  <div class="badge">2,847 PATIENTS</div>
                </div>
              </div>

              <div class="module" role="button" tabindex="0" data-action="staff">
                <div class="m-icon" style="background:linear-gradient(135deg,#60d394,#00c48c)">⚕️</div>
                <div>
                  <h4>Medical Staff</h4>
                  <p>Doctor schedules, specialist assignments, and staff management.</p>
                  <div class="badge" style="background:rgba(0,196,140,0.2);color:#00c48c">89 STAFF</div>
                </div>
              </div>

              <div class="module" role="button" tabindex="0" data-action="appointments">
                <div class="m-icon" style="background:linear-gradient(135deg,#ffb36b,#ff7a45)">📅</div>
                <div>
                  <h4>Appointments</h4>
                  <p>Schedule, reschedule, and manage patient appointments.</p>
                  <div class="badge" style="background:rgba(255,122,69,0.2);color:#ff7a45">156 TODAY</div>
                </div>
              </div>

              <div class="module" role="button" tabindex="0" data-action="billing">
                <div class="m-icon" style="background:linear-gradient(135deg,#d3c7ff,#7b61ff)">💳</div>
                <div>
                  <h4>Billing & Insurance</h4>
                  <p>Process payments, manage claims, and generate invoices.</p>
                  <div class="badge" style="background:rgba(123,97,255,0.2);color:#7b61ff">$284K REVENUE</div>
                </div>
              </div>
            </div>
          </div>

          <div class="card" style="margin-top:24px">
            <h3>Recent Activity</h3>
            <div class="recent-list">
              <div class="activity">
                <div class="left">
                  <div class="avatar-sm">AP</div>
                  <div class="meta">
                    <strong>Appointment booked — John Doe</strong>
                    <div class="muted">Cardiology · 2:00 PM · Today</div>
                  </div>
                </div>
                <div class="muted">5m ago</div>
              </div>

              <div class="activity">
                <div class="left">
                  <div class="avatar-sm">LR</div>
                  <div class="meta">
                    <strong>Lab results uploaded — Jane R.</strong>
                    <div class="muted">Blood Panel · 1hr ago</div>
                  </div>
                </div>
                <div class="muted">1h</div>
              </div>

              <div class="activity">
                <div class="left">
                  <div class="avatar-sm">NV</div>
                  <div class="meta">
                    <strong>New patient registered — Nivos Silva</strong>
                    <div class="muted">Patient ID: #004512</div>
                  </div>
                </div>
                <div class="muted">3h</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Sidebar -->
        <aside>
          <div class="card">
            <h4 style="margin:0 0 16px;color:white;font-weight:800">Quick Actions</h4>
            <div class="quick-actions">
              <a class="action-btn" href="#new-patient" data-action="#new-patient" role="button"> 
                <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 5v14M5 12h14" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                <span>New Patient</span>
              </a>

              <a class="action-btn green" href="#schedule" data-action="#schedule" role="button">
                <svg viewBox="0 0 24 24" fill="none"><path d="M8 7V3M16 7V3M3 11h18M5 21h14" stroke="#00c48c" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                <span>Schedule Appointment</span>
              </a>

              <a class="action-btn" href="#invoice" data-action="#invoice" role="button" style="border-color:rgba(255,122,69,0.3);background:rgba(255,122,69,0.1)">
                <svg viewBox="0 0 24 24" fill="none"><path d="M9 17h6M7 21h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2z" stroke="#ff7a45" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                <span>Generate Invoice</span>
              </a>

              <a class="action-btn purple" href="#reports" data-action="#reports" role="button">
                <svg viewBox="0 0 24 24" fill="none"><path d="M3 3v18h18" stroke="#7b61ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                <span>View Reports</span>
              </a>
            </div>

            <h4 style="margin:24px 0 12px;color:white;font-weight:800">System Status</h4>
            <div class="status-list">
              <div class="status-item">
                <div style="display:flex;gap:12px;align-items:center">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M5 13l4 4L19 7" stroke="#00c48c" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                  <div>
                    <div style="font-weight:700;color:white">Security & Compliance</div>
                    <div class="muted">Last audit: 12 days ago</div>
                  </div>
                </div>
                <div class="pill green">ACTIVE</div>
              </div>

              <div class="status-item">
                <div style="display:flex;gap:12px;align-items:center">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M12 3v9M19 21H5" stroke="#ffb86b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                  <div>
                    <div style="font-weight:700;color:white">Uptime</div>
                    <div class="muted">Service availability</div>
                  </div>
                </div>
                <div class="pill yellow">99.9%</div>
              </div>

              <div class="status-item">
                <div style="display:flex;gap:12px;align-items:center">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M3 7h18M6 11h12M10 15h4" stroke="#7b61ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                  <div>
                    <div style="font-weight:700;color:white">Medical Records</div>
                    <div class="muted">Syncing with cloud</div>
                  </div>
                </div>
                <div class="pill purple">SYNCED</div>
              </div>
            </div>
          </div>
        </aside>
      </section>

      <footer class="small">© 2025 MediLink Health Diagnostics (Pvt) Ltd · Colombo, Sri Lanka</footer>
    </main>
  </div>

  <script>
    // Create floating particles
    const particlesContainer = document.getElementById('particles');
    for(let i = 0; i < 15; i++){
      const particle = document.createElement('div');
      particle.className = 'particle';
      particle.style.left = Math.random() * 100 + '%';
      particle.style.animationDelay = Math.random() * 15 + 's';
      particle.style.animationDuration = (10 + Math.random() * 10) + 's';
      particlesContainer.appendChild(particle);
    }

    // Toast notification
    function showToast(text, time = 2000) {
      const t = document.createElement('div');
      t.textContent = text;
      Object.assign(t.style, {
        position: 'fixed', right: '24px', bottom: '24px', 
        background: 'linear-gradient(135deg, rgba(43,140,255,0.98), rgba(123,97,255,0.98))',
        backdropFilter: 'blur(30px) saturate(180%)',
        color: 'white', padding: '16px 24px', borderRadius: '14px', 
        boxShadow: '0 16px 48px rgba(43,140,255,0.5), 0 0 0 1px rgba(255,255,255,0.2)',
        zIndex: 9999, fontWeight: 700, fontSize: '14px', opacity: '0', 
        transition: 'all .3s cubic-bezier(0.4, 0, 0.2, 1)', 
        transform: 'translateY(20px) scale(0.9)'
      });
      document.body.appendChild(t);
      requestAnimationFrame(() => { 
        t.style.opacity = '1'; 
        t.style.transform = 'translateY(0) scale(1)'; 
      });
      setTimeout(() => { 
        t.style.opacity = '0'; 
        t.style.transform = 'translateY(20px) scale(0.9)'; 
      }, time);
      setTimeout(() => t.remove(), time + 300);
    }

    // Data storage
    const STORAGE_KEYS = { 
      PATIENTS: 'ml_patients_v1', 
      APPTS: 'ml_appointments_v1', 
      INVOICES: 'ml_invoices_v1' 
    };

    function read(key) {
      try { return JSON.parse(localStorage.getItem(key) || 'null') || []; } 
      catch(e) { return []; }
    }
    function write(key, val) { localStorage.setItem(key, JSON.stringify(val || [])); }

    function getPatients(){ return read(STORAGE_KEYS.PATIENTS); }
    function savePatients(list){ write(STORAGE_KEYS.PATIENTS, list); }
    function getAppointments(){ return read(STORAGE_KEYS.APPTS); }
    function saveAppointments(list){ write(STORAGE_KEYS.APPTS, list); }
    function getInvoices(){ return read(STORAGE_KEYS.INVOICES); }
    function saveInvoices(list){ write(STORAGE_KEYS.INVOICES, list); }

    function genId(prefix='id') { 
      return prefix + '_' + Math.random().toString(36).slice(2,9); 
    }

    // Seed sample data
    if (!getPatients().length) {
      const sample = [
        { id: genId('p'), name: 'John Doe', age: 42, phone: '077-123-4567', gender: 'Male', notes: 'Diabetic, requires regular monitoring' },
        { id: genId('p'), name: 'Jane Roe', age: 33, phone: '077-333-9988', gender: 'Female', notes: 'Pregnancy follow-up' },
        { id: genId('p'), name: 'Michael Chen', age: 28, phone: '077-555-1234', gender: 'Male', notes: 'Annual checkup' },
        { id: genId('p'), name: 'Sarah Williams', age: 45, phone: '077-666-7890', gender: 'Female', notes: 'Hypertension treatment' }
      ];
      savePatients(sample);
    }

    const mainEl = document.querySelector('main');
    const originalMain = mainEl.innerHTML;

    // Router
    const router = {
      navigate(hash) {
        if (!hash) hash = '#home';
        location.hash = hash;
      },
      start() {
        window.addEventListener('hashchange', () => this.render(location.hash || '#home'));
        this.render(location.hash || '#home');
      },
      render(hash) {
        document.querySelectorAll('nav.topnav a').forEach(a => 
          a.classList.toggle('active', a.getAttribute('href') === hash)
        );
        
        mainEl.classList.add('page-enter');
        setTimeout(() => mainEl.classList.remove('page-enter'), 500);

        switch(hash) {
          case '#patients': renderPatients(); break;
          case '#new-patient': renderNewPatient(); break;
          case '#patient-view': {
            const id = this._lastParam; 
            this._lastParam = null; 
            renderPatientView(id); 
            break;
          }
          case '#appointments': renderAppointments(); break;
          case '#schedule': renderNewAppointment(); break;
          case '#billing': renderBilling(); break;
          case '#doctors': 
          case '#staff': 
            showToast('Staff Management - Coming Soon!'); 
            renderStaffPlaceholder(); 
            break;
          case '#invoice': renderInvoiceGen(); break;
          case '#reports': renderReports(); break;
          case '#home': 
          default: 
            restoreDashboard(); 
            break;
        }
      }
    };

    function restoreDashboard(){ 
      mainEl.innerHTML = originalMain; 
      attachDelegates(); 
    }

    function renderPatients(){
      const patients = getPatients();
      mainEl.innerHTML = `
        <section class="card page-enter" style="max-width:1100px;margin:0 auto">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
            <div>
              <h2 style="margin:0;color:white;font-size:28px">Patient Management</h2>
              <div class="muted">Total patients: ${patients.length}</div>
            </div>
            <div style="display:flex;gap:12px">
              <button class="btn-outline" id="back-home">← Back</button>
              <button class="action-btn green" id="add-patient">+ New Patient</button>
            </div>
          </div>
          ${patients.length ? `
            <table>
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Age</th>
                  <th>Phone</th>
                  <th>Gender</th>
                  <th style="text-align:right">Actions</th>
                </tr>
              </thead>
              <tbody>
                ${patients.map(p=>`
                  <tr data-id="${p.id}" class="patient-row">
                    <td style="font-weight:700">${escapeHtml(p.name)}</td>
                    <td>${p.age}</td>
                    <td>${escapeHtml(p.phone)}</td>
                    <td>${escapeHtml(p.gender || '-')}</td>
                    <td style="text-align:right">
                      <button class="action-btn" style="padding:8px 14px;font-size:13px" data-action="view-${p.id}">View Details</button>
                    </td>
                  </tr>
                `).join('')}
              </tbody>
            </table>
          ` : '<div class="muted" style="padding:40px;text-align:center;font-size:16px">No patients yet — click New Patient to add one.</div>'}
        </section>
      `;

      document.getElementById('add-patient').addEventListener('click', ()=> router.navigate('#new-patient'));
      document.getElementById('back-home').addEventListener('click', ()=> router.navigate('#home'));
      
      document.querySelectorAll('.patient-row').forEach(tr => {
        tr.addEventListener('click', ()=>{
          const id = tr.dataset.id; 
          router._lastParam = id; 
          router.navigate('#patient-view');
        });
      });
      
      document.querySelectorAll('button[data-action^="view-"]').forEach(b=>{
        b.addEventListener('click', (ev)=>{ 
          ev.stopPropagation(); 
          const id = b.dataset.action.replace('view-',''); 
          router._lastParam = id; 
          router.navigate('#patient-view'); 
        });
      });
    }

    function renderNewPatient(){
      mainEl.innerHTML = `
        <section class="card page-enter" style="max-width:720px;margin:0 auto">
          <h2 style="color:white;font-size:28px">Add New Patient</h2>
          <div class="muted" style="margin-bottom:20px">Fill in the patient information below</div>
          <form id="form-new" style="display:grid;gap:14px">
            <input name="name" placeholder="Full Name *" required />
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px">
              <input name="age" type="number" placeholder="Age *" required />
              <input name="phone" placeholder="Phone Number *" required />
            </div>
            <select name="gender" required>
              <option value="">Select Gender *</option>
              <option value="Male">Male</option>
              <option value="Female">Female</option>
              <option value="Other">Other</option>
            </select>
            <textarea name="notes" placeholder="Medical Notes (optional)" rows="4"></textarea>
            <div style="display:flex;gap:12px;justify-content:flex-end;margin-top:12px">
              <button type="button" class="btn-outline" id="cancel-new">Cancel</button>
              <button type="submit" class="action-btn green">Create Patient</button>
            </div>
          </form>
        </section>
      `;
      
      document.getElementById('cancel-new').addEventListener('click', ()=> router.navigate('#patients'));
      document.getElementById('form-new').addEventListener('submit', function(e){
        e.preventDefault();
        const fd = new FormData(e.target);
        const p = { 
          id: genId('p'), 
          name: fd.get('name').trim(), 
          age: Number(fd.get('age')||0), 
          phone: fd.get('phone')||'', 
          gender: fd.get('gender')||'', 
          notes: fd.get('notes')||'' 
        };
        const list = getPatients(); 
        list.unshift(p); 
        savePatients(list);
        showToast('✓ Patient created successfully!');
        router._lastParam = p.id; 
        router.navigate('#patient-view');
      });
    }

    function renderPatientView(id){
      const p = getPatients().find(x=>x.id===id);
      if (!p) { 
        showToast('Patient not found'); 
        return router.navigate('#patients'); 
      }
      
      mainEl.innerHTML = `
        <section class="card page-enter" style="max-width:720px;margin:0 auto">
          <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:24px">
            <div>
              <h2 style="margin:0;color:white;font-size:28px">${escapeHtml(p.name)}</h2>
              <div class="muted">Patient ID: ${p.id}</div>
            </div>
            <div style="display:flex;gap:10px">
              <button class="btn-outline" id="back-to-patients">← Back</button>
              <button class="action-btn" id="edit-patient">Edit</button>
              <button class="action-btn" id="delete-patient" style="border-color:rgba(255,122,69,0.3);background:rgba(255,122,69,0.1)">Delete</button>
            </div>
          </div>
          <div style="display:grid;gap:16px">
            <div style="padding:16px;background:rgba(255,255,255,0.05);border-radius:12px;border:1px solid rgba(255,255,255,0.1)">
              <div style="color:rgba(255,255,255,0.6);font-size:12px;text-transform:uppercase;letter-spacing:0.5px;margin-bottom:6px">Age</div>
              <div style="color:white;font-size:20px;font-weight:700">${p.age} years</div>
            </div>
            <div style="padding:16px;background:rgba(255,255,255,0.05);border-radius:12px;border:1px solid rgba(255,255,255,0.1)">
              <div style="color:rgba(255,255,255,0.6);font-size:12px;text-transform:uppercase;letter-spacing:0.5px;margin-bottom:6px">Phone</div>
              <div style="color:white;font-size:18px;font-weight:600">${escapeHtml(p.phone)}</div>
            </div>
            <div style="padding:16px;background:rgba(255,255,255,0.05);border-radius:12px;border:1px solid rgba(255,255,255,0.1)">
              <div style="color:rgba(255,255,255,0.6);font-size:12px;text-transform:uppercase;letter-spacing:0.5px;margin-bottom:6px">Gender</div>
              <div style="color:white;font-size:18px;font-weight:600">${escapeHtml(p.gender) || '-'}</div>
            </div>
            <div style="padding:16px;background:rgba(255,255,255,0.05);border-radius:12px;border:1px solid rgba(255,255,255,0.1)">
              <div style="color:rgba(255,255,255,0.6);font-size:12px;text-transform:uppercase;letter-spacing:0.5px;margin-bottom:6px">Medical Notes</div>
              <div style="color:white;font-size:15px;line-height:1.6">${escapeHtml(p.notes) || 'No notes available'}</div>
            </div>
          </div>
        </section>
      `;
      
      document.getElementById('back-to-patients').addEventListener('click', ()=> router.navigate('#patients'));
      document.getElementById('edit-patient').addEventListener('click', ()=> renderEditPatient(id));
      document.getElementById('delete-patient').addEventListener('click', ()=>{
        if (!confirm('Are you sure you want to delete this patient?')) return;
        const list = getPatients().filter(x=>x.id!==id); 
        savePatients(list);
        showToast('✓ Patient deleted');
        router.navigate('#patients');
      });
    }

    function renderEditPatient(id){
      const p = getPatients().find(x=>x.id===id);
      if (!p) return router.navigate('#patients');
      
      mainEl.innerHTML = `
        <section class="card page-enter" style="max-width:720px;margin:0 auto">
          <h2 style="color:white;font-size:28px">Edit Patient</h2>
          <div class="muted" style="margin-bottom:20px">Update patient information</div>
          <form id="form-edit" style="display:grid;gap:14px">
            <input name="name" value="${escapeHtml(p.name)}" required />
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px">
              <input name="age" type="number" value="${p.age}" required />
              <input name="phone" value="${escapeHtml(p.phone)}" required />
            </div>
            <select name="gender" required>
              <option value="">Select Gender</option>
              <option value="Male" ${p.gender==='Male'?'selected':''}>Male</option>
              <option value="Female" ${p.gender==='Female'?'selected':''}>Female</option>
              <option value="Other" ${p.gender==='Other'?'selected':''}>Other</option>
            </select>
            <textarea name="notes" rows="4">${escapeHtml(p.notes||'')}</textarea>
            <div style="display:flex;gap:12px;justify-content:flex-end;margin-top:12px">
              <button type="button" class="btn-outline" id="cancel-edit">Cancel</button>
              <button type="submit" class="action-btn green">Save Changes</button>
            </div>
          </form>
        </section>
      `;
      
      document.getElementById('cancel-edit').addEventListener('click', ()=> {
        router._lastParam = id; 
        router.navigate('#patient-view');
      });
      
      document.getElementById('form-edit').addEventListener('submit', function(e){
        e.preventDefault(); 
        const fd = new FormData(e.target);
        const list = getPatients(); 
        const idx = list.findIndex(x=>x.id===id);
        if (idx === -1) return showToast('Patient not found');
        
        list[idx] = { 
          ...list[idx], 
          name: fd.get('name').trim(), 
          age: Number(fd.get('age')||0), 
          phone: fd.get('phone')||'', 
          gender: fd.get('gender')||'', 
          notes: fd.get('notes')||'' 
        };
        savePatients(list); 
        showToast('✓ Changes saved successfully!'); 
        router._lastParam = id; 
        router.navigate('#patient-view');
      });
    }

    function renderAppointments(){
      const appts = getAppointments();
      const patients = getPatients();
      
      mainEl.innerHTML = `
        <section class="card page-enter" style="max-width:900px;margin:0 auto">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
            <div>
              <h2 style="margin:0;color:white;font-size:28px">Appointments</h2>
              <div class="muted">Manage all patient appointments</div>
            </div>
            <div style="display:flex;gap:12px">
              <button class="btn-outline" id="back-home-2">← Back</button>
              <button class="action-btn green" id="new-appt">+ Schedule New</button>
            </div>
          </div>
          ${appts.length ? `
            <div style="display:grid;gap:12px">
              ${appts.map(a=>{
                const patient = patients.find(p=>p.id===a.patientId) || {name:'Unknown'};
                return `
                  <div class="activity">
                    <div class="left">
                      <div class="avatar-sm">${patient.name.split(' ').map(n=>n[0]).slice(0,2).join('')}</div>
                      <div class="meta">
                        <strong>${escapeHtml(patient.name)}</strong>
                        <div class="muted">${escapeHtml(a.date)} at ${escapeHtml(a.time)} · ${escapeHtml(a.type||'Checkup')}</div>
                      </div>
                    </div>
                    <div class="pill green">SCHEDULED</div>
                  </div>
                `;
              }).join('')}
            </div>
          ` : '<div class="muted" style="padding:40px;text-align:center;font-size:16px">No appointments scheduled yet.</div>'}
        </section>
      `;
      
      document.getElementById('back-home-2').addEventListener('click', ()=> router.navigate('#home'));
      document.getElementById('new-appt').addEventListener('click', ()=> router.navigate('#schedule'));
    }

    function renderNewAppointment(){
      const patients = getPatients();
      if (!patients.length) {
        showToast('Please add patients first');
        return router.navigate('#patients');
      }
      
      mainEl.innerHTML = `
        <section class="card page-enter" style="max-width:720px;margin:0 auto">
          <h2 style="color:white;font-size:28px">Schedule Appointment</h2>
          <div class="muted" style="margin-bottom:20px">Book a new patient appointment</div>
          <form id="form-appt" style="display:grid;gap:14px">
            <select name="patientId" required>
              <option value="">Select Patient *</option>
              ${patients.map(p=>`<option value="${p.id}">${escapeHtml(p.name)}</option>`).join('')}
            </select>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px">
              <input name="date" type="date" required />
              <input name="time" type="time" required />
            </div>
            <input name="type" placeholder="Appointment Type (e.g., Checkup, Consultation)" />
            <div style="display:flex;gap:12px;justify-content:flex-end;margin-top:12px">
              <button type="button" class="btn-outline" id="cancel-appt">Cancel</button>
              <button type="submit" class="action-btn green">Schedule</button>
            </div>
          </form>
        </section>
      `;
      
      document.getElementById('cancel-appt').addEventListener('click', ()=> router.navigate('#appointments'));
      document.getElementById('form-appt').addEventListener('submit', function(e){
        e.preventDefault(); 
        const fd = new FormData(e.target);
        const a = { 
          id: genId('a'), 
          patientId: fd.get('patientId'), 
          date: fd.get('date'), 
          time: fd.get('time'), 
          type: fd.get('type') || 'Checkup'
        };
        const list = getAppointments(); 
        list.unshift(a); 
        saveAppointments(list); 
        showToast('✓ Appointment scheduled!'); 
        router.navigate('#appointments');
      });
    }

    function renderBilling(){
      const invoices = getInvoices();
      
      mainEl.innerHTML = `
        <section class="card page-enter" style="max-width:900px;margin:0 auto">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
            <div>
              <h2 style="margin:0;color:white;font-size:28px">Billing & Invoices</h2>
              <div class="muted">Manage payments and invoices</div>
            </div>
            <div style="display:flex;gap:12px">
              <button class="btn-outline" id="back-home-3">← Back</button>
              <button class="action-btn green" id="new-invoice">+ New Invoice</button>
            </div>
          </div>
          ${invoices.length ? `
            <div style="display:grid;gap:12px">
              ${invoices.map(inv=>`
                <div class="activity">
                  <div class="left">
                    <div class="avatar-sm" style="background:linear-gradient(135deg,#ffb36b,#ff7a45)">$</div>
                    <div class="meta">
                      <strong>${escapeHtml(inv.title||'Invoice')}</strong>
                      <div class="muted">${escapeHtml(inv.date)} · ${escapeHtml(inv.amount)}</div>
                    </div>
                  </div>
                  <div class="pill green">PAID</div>
                </div>
              `).join('')}
            </div>
          ` : '<div class="muted" style="padding:40px;text-align:center;font-size:16px">No invoices yet.</div>'}
        </section>
      `;
      
      document.getElementById('back-home-3').addEventListener('click', ()=> router.navigate('#home'));
      document.getElementById('new-invoice').addEventListener('click', ()=> router.navigate('#invoice'));
    }

    function renderInvoiceGen(){
      mainEl.innerHTML = `
        <section class="card page-enter" style="max-width:720px;margin:0 auto">
          <h2 style="color:white;font-size:28px">Generate Invoice</h2>
          <div class="muted" style="margin-bottom:20px">Create a new billing invoice</div>
          <form id="form-invoice" style="display:grid;gap:14px">
            <input name="title" placeholder="Invoice Title *" required />
            <input name="amount" placeholder="Amount (e.g., $500) *" required />
            <input name="date" type="date" required />
            <textarea name="description" placeholder="Description (optional)" rows="3"></textarea>
            <div style="display:flex;gap:12px;justify-content:flex-end;margin-top:12px">
              <button type="button" class="btn-outline" id="cancel-inv">Cancel</button>
              <button type="submit" class="action-btn green">Create Invoice</button>
            </div>
          </form>
        </section>
      `;
      
      document.getElementById('cancel-inv').addEventListener('click', ()=> router.navigate('#billing'));
      document.getElementById('form-invoice').addEventListener('submit', function(e){
        e.preventDefault();
        const fd = new FormData(e.target);
        const inv = {
          id: genId('inv'),
          title: fd.get('title'),
          amount: fd.get('amount'),
          date: fd.get('date'),
          description: fd.get('description') || ''
        };
        const list = getInvoices();
        list.unshift(inv);
        saveInvoices(list);
        showToast('✓ Invoice created!');
        router.navigate('#billing');
      });
    }

    function renderStaffPlaceholder(){
      mainEl.innerHTML = `
        <section class="card page-enter" style="max-width:720px;margin:0 auto;text-align:center;padding:60px 40px">
          <div style="font-size:64px;margin-bottom:20px">⚕️</div>
          <h2 style="color:white;font-size:28px;margin-bottom:12px">Staff Management</h2>
          <div class="muted" style="margin-bottom:30px">This feature is coming soon! Manage doctor schedules and staff assignments.</div>
          <button class="btn-outline" onclick="router.navigate('#home')">← Back to Dashboard</button>
        </section>
      `;
    }

    function renderReports(){
      mainEl.innerHTML = `
        <section class="card page-enter" style="max-width:720px;margin:0 auto;text-align:center;padding:60px 40px">
          <div style="font-size:64px;margin-bottom:20px">📊</div>
          <h2 style="color:white;font-size:28px;margin-bottom:12px">Analytics & Reports</h2>
          <div class="muted" style="margin-bottom:30px">View detailed analytics and generate comprehensive reports.</div>
          <button class="btn-outline" onclick="router.navigate('#home')">← Back to Dashboard</button>
        </section>
      `;
    }

    function attachDelegates(){
      document.querySelectorAll('[data-action]').forEach(el=>{
        el.addEventListener('click', handleAction);
      });
    }

    function handleAction(e){
      e.preventDefault();
      const el = e.currentTarget;
      const action = el.dataset.action || el.getAttribute('href');
      
      if (!action) return;
      
      if (action === 'logout') {
        showToast('Logging out...');
        setTimeout(() => showToast('Logged out successfully'), 1000);
        return;
      }
      
      if (action.startsWith('#')) {
        router.navigate(action);
      } else if (action === 'patients-list') {
        router.navigate('#patients');
      } else if (action === 'appointments') {
        router.navigate('#appointments');
      } else if (action === 'billing') {
        router.navigate('#billing');
      } else if (action === 'staff') {
        router.navigate('#staff');
      } else {
        showToast(action);
      }
    }

    function escapeHtml(s){ 
      return String(s||'').replace(/[&<>"']/g, c=>({
        "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"
      })[c]); 
    }

    // Global click handler
    document.addEventListener('click', function(e){
      const el = e.target.closest('[data-action], nav.topnav a, .module, .action-btn, .stat');
      if (el && el.hasAttribute('data-action')) {
        e.preventDefault();
        handleAction.call(el, e);
      }
    });

    // Keyboard navigation
    document.addEventListener('keydown', function(e){
      if ((e.key === 'Enter' || e.key === ' ') && document.activeElement) {
        const el = document.activeElement;
        if (el.matches('[data-action], .module, .action-btn, nav.topnav a')) {
          e.preventDefault();
          el.click();
        }
      }
    });

    // Start the app
    router.start();
  </script>
</body>
</html>